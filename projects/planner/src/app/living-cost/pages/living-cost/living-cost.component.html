<ng-template #actionBar>
  @if (livingCosts?.length) {
    <lib-button type="secondary" [isDisabled]="isEditing" (click)="onAddLivingCost()">
      Add Cost of living scenario
    </lib-button>
  }
</ng-template>

@if (isLoading) {
  <div class="col-md-8 m-auto pt-3 d-flex align-content-center">
    <div class="d-flex m-auto">
      <mat-spinner diameter="28"></mat-spinner>
    </div>
  </div>
} @else {
  <div class="d-block col-md-8 m-auto pt-3">
    @if (!livingCosts?.length) {
      <lib-card class="d-flex flex-column p-3 mt-5">
        <app-card-header
          class="pb-3 bottom-border"
          [title]="'Cost of living scenario'"></app-card-header>
        <div class="pt-3 card-content">
          <div
            class="action-container d-flex ml-auto align-content-center flex-wrap justify-content-end">
            <lib-button type="secondary" [isDisabled]="isEditing" (click)="onAddLivingCost()"
              >Add Cost of living scenario</lib-button
            >
          </div>
        </div>
      </lib-card>
    } @else {
      @for (livingCost of livingCosts; track livingCost.id) {
        <lib-card class="d-flex flex-column p-3 mt-5" (click)="onUpdateLivingCost(livingCost)">
          <app-card-header
            class="pb-3 bottom-border"
            [title]="'Income scenario'"
            [chipConfig]="getChipConfig(livingCost)">
            @if (getActionVisibility(livingCost)) {
              <ng-container ngProjectAs="[action-bar]">
                <lib-button
                  type="tertiary"
                  [isDisabled]="isEditing"
                  (click)="onBaselineLivingCostChange(livingCost)">
                  <mat-icon>favorite_outline</mat-icon>
                </lib-button>
                <lib-button type="tertiary" [isDisabled]="isEditing" (click)="onDelete(livingCost)">
                  <mat-icon>delete_outline</mat-icon>
                </lib-button>
              </ng-container>
            }
            <div>
              <h2>{{ livingCost?.total || '' | shortAmountOfMoney }}</h2>
            </div>
          </app-card-header>
          <div class="container pt-3">
            <div class="row">
              <div class="col-6">
                <div class="d-flex">
                  <mat-icon>credit_card</mat-icon>
                  @if (livingCost.mortgage) {
                    <lib-text class="pl-2">
                      salary {{ livingCost.mortgage || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>payments</mat-icon>
                  @if (livingCost.rent) {
                    <lib-text class="pl-2">
                      pension {{ livingCost.rent || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>account_balance</mat-icon>
                  @if (livingCost.loans) {
                    <lib-text class="pl-2">
                      deposit {{ livingCost.loans || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>topic</mat-icon>
                  @if (livingCost.utilities) {
                    <lib-text class="pl-2">
                      other {{ livingCost.utilities || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>topic</mat-icon>
                  @if (livingCost.education) {
                    <lib-text class="pl-2">
                      other {{ livingCost.education || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>topic</mat-icon>
                  @if (livingCost.markets) {
                    <lib-text class="pl-2">
                      other {{ livingCost.markets || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>topic</mat-icon>
                  @if (livingCost.transportation) {
                    <lib-text class="pl-2">
                      other {{ livingCost.transportation || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
                <div class="d-flex">
                  <mat-icon>topic</mat-icon>
                  @if (livingCost.other) {
                    <lib-text class="pl-2">
                      other {{ livingCost.other || '' | shortAmountOfMoney }}
                    </lib-text>
                  }
                </div>
              </div>
            </div>
          </div>
        </lib-card>
      }
    }
  </div>
}

<ng-template #drawer>
  <app-living-cost-detail
    [livingCostModel]="livingCost"
    (cancel)="onCancel()"
    (livingCostDetailChange)="onLivingCostDetailChange($event)"></app-living-cost-detail>
</ng-template>
